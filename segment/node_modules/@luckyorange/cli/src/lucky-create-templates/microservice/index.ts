
import { router, get } from 'microrouter'
const { corsHandler, getDefaultCorsHeaders, trailingSlash } = require('@luckyorange/utilities-microservice')
const resources = require('@luckyorange/utilities-resource-api')
{{#if features.admin}}
const cors = require('micro-cors-multiple-allow-origin')({
  origin: ['https://localhost:8080', 'http://localhost:8080', 'https://admin.tapuzmazal.com', 'https://admin-staging.tapuzmazal.com'],
  allowHeaders: ['Authorization', 'Content-Type', 'X-Lucky-Uid', 'X-Lucky-Site-Id', 'x-requested-with']
})
{{else}}
const cors = corsHandler({
  allowHeaders: getDefaultCorsHeaders()
})
{{/if}}

// Export routes
const routes = router(
  get('/_health', require('./src/actions/health')){{#if features.resources}},
  ...resources([
    // Ex. require('./src/resources/my-resource')
  ])
  {{/if}}
)

module.exports = cors(trailingSlash(routes))
