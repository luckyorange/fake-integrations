FROM node:12

# Set app directory
WORKDIR /usr/src/app

# Copy package.json
COPY .npmrc ./
COPY package*.json ./

# Install dependencies.
ARG NPM_TOKEN
RUN npm install --unsafe-perm --only=production

# Copy application code.
COPY . .
RUN rm -f .npmrc

# Run the app
EXPOSE 8080
CMD ["npm", "start"]
