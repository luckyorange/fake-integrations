import fs from 'fs'

const updatePackageJson = (path: string, fields: {[key: string]: any}) => {
  const packageJson = JSON.parse(fs.readFileSync(path, 'utf8'))

  Object.entries(fields).forEach(([key, value]) => {
    let currentField = packageJson[key] || {}

    switch (typeof value) {
      case 'object':
        currentField = {
          ...currentField,
          ...value
        }
        break
      case 'string':
        currentField = value
        break
      default:
        break
    }
    packageJson[key] = currentField
  })

  try {
    fs.writeFileSync(path, JSON.stringify(packageJson, null, 2), 'utf8')
  } catch (error) {
    console.log('An error has occurred ', error)
  }
}

export default updatePackageJson
